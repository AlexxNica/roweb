---
name: curl-options
layout: post
title: Curling - fun with accessing web resources from R
date: 2014-12-10
authors:
  - name: Scott Chamberlain
tags:
- R
- API
- curl
---

```{r echo=FALSE}
knitr::opts_chunk$set(
  comment = "#>",
  collapse = TRUE,
  warning = FALSE,
  message = FALSE
)
```

rOpenSci specializes in creating R libraries for accessing data resources on the web from R. Most times you request data from the web in R with our packages, you should have no problem. However, you evenutally will run into problems. In addition, there are advanced things you can do modifying requests to web resources that sort of fall in the _advanced stuff_ category.

Underlying almost all of our packages are requests to web resources served over the `http` protocol via [curl][curl]. `curl` _is a command line tool and library for transferring data with URL syntax, supporting (lots of protocols)_ . `curl` has many options that can be used, but which you may not know about.

I'll go over some of the common and less commonly used curl options.


## Discover curl options

You can go to the source, that is the curl manual page at [http://curl.haxx.se/docs/manpage.html](http://curl.haxx.se/docs/manpage.html). In R: `RCurl::listCurlOptions()` for finding curl options, give website for more info and equivalent call in `httr` is `httr::httr_options()`. `httr::httr_options()` gives more information for each curl option, including the libcurl variable name (e.g., `CURLOPT_CERTINFO`) and the type of variable (e.g., logical).

## Other ways to use curl besides R

Perhaps the canonical way is via the command line. You can get curl for your operating system at [http://curl.haxx.se/download.html](http://curl.haxx.se/download.html). Once you have curl, you can have lots of fun. For example, get the contents of the Google landing page:

```sh
curl https://www.google.com
```

* If you like that you may also like [httpie](https://github.com/jakubroztocil/httpie), a Python command line tool that is a little more convenient.
* Alot of data from the web is in JSON format. A great command line tool to pair with `curl` is [jq][jq].

## Install httr

> Note: `RCurl` is a dependency, so you'll get it when you install `httr`

```{r eval=FALSE}
install.packages("httr")
```

There are some new features in `httr` dev version you may want, if so do:

```{r}
install.packages("devtools")
devtools::install_github("hadley/httr")
```

Load `httr`

```{r}
library("httr")
```

## timeout

> Set a timeout for a request. If request exceeds timeout, request stops. 

* `httr`: `timeout()`
* `RCurl`: `timeout.ms`

```{r}
```

## verbose

> Print detailed info on a curl call 

* `httr`: `verbose()`
* `RCurl`: `verbose`

```{r}
```

## headers

> Add headers to modify requests, including authentication, setting content-type, accept type, etc.

* `httr`: `add_headers()` 
* `RCurl`: `???`

```{r}
```

## authenticate

> Set authentication details for a resource.

* `httr`: `authenticate()`, `_`
* `RCurl`: `???`

```{r}
```

## cookies

> Set cookies.

* `httr`: `set_cookies()` 
* `RCurl`: `cookie`

```{r}
```

## progress

> Print curl progress

* `httr`: `progress()` 
* `RCurl`: `progressfunction`

```{r}
```

## proxies

> When behind a proxy, give authentiction details for your proxy.

* `httr`: `use_proxy()` 
* `RCurl`: See various curl options that start with `proxy`

```{r}
```

## user agent

> Some resources require a user-agent string.

* `httr`: `user_agent()` 
* `RCurl`: `useragent`

```{r}
```

[curl]: http://curl.haxx.se/
[jq]: http://stedolan.github.io/jq/
